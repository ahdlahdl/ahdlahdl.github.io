<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="css/bootstrap.min.css"/>

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"/>

<link rel="stylesheet" href="css/simple-sidebar.css"/>

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<link href="https://fonts.googleapis.com/css?family=Amaranth" rel="stylesheet">

<script src="js/common.js"></script>
<script type="text/javascript">
loadScript("js/urlbox.js", true);
loadScript("js/channel.js", true);
loadScript("js/viewer.js", true);
</script>
<!-- script src="js/view.js"></script-->

<style type="text/css">
.viewer {}

.top_menu {margin-bottom:5px;}
.category_menu {float:left;}
.total_search {margin-left:10px;margin-right:10px;float:left;}
.total_search .url {margin-left:10px;width:200px;float:left;}

.channel {float:left;/*min-width:300px;width:30%;*/width:350px;margin-right:1px;}
.channel .url {width:250px;float:left;}
.channel iframe {border-width:1px;width:100%;height:100%;min-height:450px;}

.counter { float:right;font-size:11px;}
.counter .txt {color:RED;margin-right:7px;width:40px;}
.counter .cnt {text-align:right;width:30px;}

.topbrand {height:50px;text-align:center;width:100%;background-color:#0070C0;font-size:32px;font-family:'Amaranth',sans-serif;color:#EEEEEE}

.category_menu .title {color:#FFFFFF;font-size:18px;margin-left:10px;margin-right:10px;}

iframe {background-color:#ffffff;}
</style>
</head>
<body style="background-color:#4597D1">
    	<div class="topbrand">
    	kiwi
    	</div>

    <div id="wrapper">

        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav leftMenu">
<!--
                <li class="sidebar-brand">
                    <span>
                        quick view
                    </span>
                </li>
-->
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

	<div class="top_menu">
		<div class="category_menu"></div>

		<div class="total_search">
			<input class="form-control url" type="text"/><a class="btn btn-success search" href="#">검색</a>
		</div>
		
		<div class="tools">
			<a class="btn btn-primary geturl" href="#">URL 생성</a>
			<a class="btn btn-primary addChannel" href="#">창 추가</a>
			
			<div id="overallCounter" class="counter">
				<span class="txt">TOTAL</span><span class="cnt total"></span><br>
				<span class="txt">TODAY</span><span class="cnt today"></span>
			</div>

		</div>
		
	</div>

    <div class="viewer">
    	<div class="channel" id="frm1" style="display:none;">
			<input class="form-control url" type="text"/><a class="btn btn-success search" href="#">↙</a>
			<a class="btn btn-warning btn-sm narrow" href="#">-</a><a class="btn btn-warning btn-sm wide" href="#">+</a>
	        <iframe src="blank.html" target="_blank"></iframe>
    	</div>

    	<div class="channel" id="frm2" style="display:none;">
			<input class="form-control url" type="text"/><a class="btn btn-success search" href="#">↙</a>
			<a class="btn btn-warning btn-sm narrow" href="#">-</a><a class="btn btn-warning btn-sm wide" href="#">+</a>
	        <iframe src="blank.html"></iframe>
    	</div>

    	<div class="channel" id="frm3" style="display:none;">
			<input class="form-control url" type="text"/><a class="btn btn-success search" href="#">↙</a>
			<a class="btn btn-warning btn-sm narrow" href="#">-</a><a class="btn btn-warning btn-sm wide" href="#">+</a>
	        <iframe src="blank.html"></iframe>
    	</div>
    	
    	<div class="channel" id="frm4" style="display:none;">
			<input class="form-control url" type="text"/><a class="btn btn-success search" href="#">↙</a>
			<a class="btn btn-warning btn-sm narrow" href="#">-</a><a class="btn btn-warning btn-sm wide" href="#">+</a>
	        <iframe src="blank.html"></iframe>
    	</div>
    	
    	<div class="channel" id="frm5" style="display:none;">
			<input class="form-control url" type="text"/><a class="btn btn-success search" href="#">↙</a>
			<a class="btn btn-warning btn-sm narrow" href="#">-</a><a class="btn btn-warning btn-sm wide" href="#">+</a>
	        <iframe src="blank.html"></iframe>
    	</div>
    </div>
</div>
<script type="text/javascript">

var Category = function(_name, _id, _parent) {
	this.name = _name;
	this.id = _id;
	this.parent = _parent ? _parent : null;
}

var aCategories = [
               {"id":1,"name":"포털","parent":null},
               {"id":2,"name":"뉴스","parent":null},
               
               {"id":3,"name":"홈","parent":1},
               {"id":4,"name":"웹툰","parent":1},
               
               {"id":6,"name":"조중동","parent":2},
               {"id":7,"name":"오마이","parent":2},
               
               {"id":9,"name":"네이버","parent":3,data:{"url":"http://m.naver.com","width":350}},
               {"id":10,"name":"다음","parent":3,data:{"url":"http://m.daum.net","width":350}},
               {"id":11,"name":"네이트","parent":3,data:{"url":"http://m.nate.com","width":350}},
               
               {"id":12,"name":"네이버 웹툰","parent":4,data:{"url":"http://m.comic.naver.com","width":350}},
               {"id":13,"name":"다음 웹툰","parent":4,data:{"url":"http://m.webtoon.daum.net","width":350}},
               {"id":14,"name":"네이트 웹툰","parent":4,data:{"url":"http://m.comics.nate.com","width":350}},

               {"id":15,"name":"조선","parent":6,data:{"url":"http://m.chosun.com","width":350}},
               {"id":16,"name":"중앙","parent":6,data:{"url":"http://mnews.joins.com/","width":350}},
               {"id":17,"name":"동아","parent":6,data:{"url":"http://m.donga.com/","width":350}},
               
               {"id":18,"name":"오마이","parent":7,data:{"url":"http://m.ohmynews.com/","width":350}},
               {"id":19,"name":"프레시안","parent":7,data:{"url":"http://m.pressian.com/m/","width":350}},
               {"id":20,"name":"미디어오늘","parent":7,data:{"url":"http://m.mediatoday.co.kr/","width":350}}
];

function getherSubCategories(parentId) {
	var aList = [];
	for (var i = 0; i < aCategories.length; i++) {
		var catg = aCategories[i];
		if (!catg.id) {
			continue;
		}
		if (catg.parent == parentId) {
			var aSubCategories = getherSubCategories(catg.id);
			if (aSubCategories.length > 0) {
				catg.list = aSubCategories;
			}
			delete catg["id"];
			delete catg["parent"];
			aList.push(catg);
		}
	}
	return aList;
} 
var aMenuTree = getherSubCategories(null);

function drawMenu(aMenuTree, welMainMenus, welSubMenus) {
	
	var paintTop = function() {
		for (var i = 0; i < aMenuTree.length; i++) {
			var htMenu = aMenuTree[i];
			var welMenu = $("<li><a href='#'>" + htMenu.name + "</a></li>");
			welMainMenus.append(welMenu);
			
			welMenu.click(function(_htMenu) {
				return function(we) {
					we.preventDefault();
					paintSubMenus(_htMenu);
				}
			}(htMenu));
		}
	}

	var paintSubMenus = function(htMenu) {
		welSubMenus.html("");
		
		var welTitle = $("<span class='title'>" + htMenu.name + "</span>");
		welSubMenus.append(welTitle);
		
		var aList = htMenu.list;
		for (var i = 0; i < aList.length; i++) {
			var htData = aList[i];
			var welMenu = $("<a class='btn btn-info menu' href='#'>" + htData.name + "</a>");
			welSubMenus.append(welMenu);
			welMenu.click(function(_htData) {
				return function(we) {
					we.preventDefault();
					var list = [];
					for (var j = 0; j < _htData.list.length; j++) {
						var ht = _htData.list[j];
						list.push(ht.data);
					}
					
					viewer.changeCategory(list);
				}
			}(htData));
		}
	}
	
	paintTop();
}
drawMenu(aMenuTree, $(".leftMenu"), $(".category_menu"));


$(document).ready(function() {
	viewer.init($(".channel"));
	
	var hash = location.hash.replace(/^#/, "");
	var htInfo = {};
	if (hash && $.trim(hash).length > 0) {
		htInfo = JSON.parse(hash);
	}
	
	if (htInfo.list && htInfo.list.length > 0) {
		viewer.changeCategory(htInfo.list);
	} else {
		viewer.changeCategory(aSiteMapList[0].list);
	}

	resizeIframes();
	
	var totalSearchBox = new UrlBox({
		container : $(".total_search"),
		search : function(keyword) {
			viewer.changeCategory([
			                       new Url("네이버", "http://m.search.naver.com/search.naver?query=" + keyword),
			                       new Url("다음", "https://m.search.daum.net/search?q=" + keyword),
			                       new Url("네이트", "https://m.search.daum.net/nate?w=tot&thr=mnms&q=" + keyword)
		    ]);
		}
	});
	
	$(".addChannel").click(function(we) {
		we.preventDefault();
		viewer.addChannel();
	});
	
	$(".geturl").click(function(we) {
		we.preventDefault();
		location.hash = JSON.stringify(viewer.getInfo());
	});
	
	new Counter("sanview", $("#overallCounter"));
});

function resizeIframes() {
	var win = $(this);
    var awelIframe = $(".channel iframe");
    awelIframe.each(function() {
    	$(this).height(win.height() - 100);
    });
}

$(window).on('resize', resizeIframes);


(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-87941781-1', 'auto');
ga('send', 'pageview');

</script>
</body>
</html>
